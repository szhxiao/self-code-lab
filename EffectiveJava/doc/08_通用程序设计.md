# 第 8 章 通用程序设计

## 第 45 条：将局部变量的作用域最小化

将局部变量的作用域最小化，可以增强代码的可读性和可维护性，并降低出错的可能性。

1. 要使局部变量的作用域最小化，最有力的方法就是在第一次使用它的地方声明。

    局部变量的作用域从它被声明的点开始扩展，一起到外围块处结束。

2. 几乎每个局部变量的声明都应该包含一个初始化表达式，如果没有足够的信息来对一个变量进行有意义的初始化，就应该推迟声明，直到可以初始化为止。

3. 使方法小而集中。

## 第 46 条：for-each 循环优先于传统的 for 循环

for-each 循环通过完全隐藏迭代器或者索引变量，避免了混乱和出错。复用 for-each 循环不会有性能损失。

for-each 循环不仅让可以遍历集合和数组，还可以遍历任务实现 Iterable 接口的对象。

无法使用 for-each 循环的情况：

-   过滤

    如果需要遍历集合，并删除选定的元素，就需要使用显式的迭代器。

-   转换

    如果需要遍历列表或者数组，并取代它部分或者全部的元素值，就需要列表迭代器或者数组索引。

-   平行迭代

    如果需要并行地遍历多个集合，就需要显式地控制迭代器或者索引变量，以便所有迭代器或者索引变量可以同步前移。

## 第 47 条：了解和使用类库

使用标准类库的好处：

-   通过使用标准类库，可以充分复用编写标准类库的专家的知识，以及之前的其他人的使用经验；
-   不必浪费时间为那些与工作不太相关的问题提供特别的解决方案；
-   标准类库的性能往往会随着时间的推移而不断提高；
-   可以使自己的代码融入主流。

**不要重新发明轮子。**

## 第 48 条：如果需要精确的答案，请避免使用 float 和 double

对于任何需要精确答案的计算任务，请不要使用 float 或者 double。

## 第 49 条：基本类型优先于装箱基本类型

1. 基本类型和装箱基本类型间的区别

    - 基本类型只有值，装箱基本类型则具有与它们的值不同的同一性；
    - 基本类型只有功能完备的值，每个装箱基本类型除了它对应基本类型的所有功能值之外，还有个非功能值：null；
    - 基本类型通常比装箱基本类型更节省时间和空间。

当在一项操作中混合使用基本类型和装箱基本类型时，装箱基本类型就会自动拆箱。

2. 装箱基本类型的使用场景

    - 作为集合中的元素、键和值；
    - 在参数化类型中，必须使用装箱基本类型作为类型参数；
    - 在进行反射的方法调用时，必须使用装箱基本类型。

**当可以选择的时候，基本类型要优先于装箱基本类型。**

## 第 50 条：如果其他类型更适合，则尽量避免使用字符串

1. 不应该使用字符串的情形：

    - 字符串不适合代替其他的值类型
    - 字符串不适合代替枚举类型
    - 字符串不适合代替聚集类型
    - 字符串不适合代替能力表

## 第 51 条：当心字符串连接的性能

不要使用字符串连接操作符来合并多个字符串，除非性能无关紧要。相反，应该使用 StringBuilder 的 append 方法。

## 第 52 条：通过接口引用对象

应该优先使用接口而不是类来引用对象。如果有合适的接口类型存在，那么对于参数、返回值、变量和域来说，就都应该使用接口类型进行声明。

## 第 53 条：接口优先于反射机制

通常，普通应用程序在运行时不应该以反射方式访问对象。

反射机制是一种功能强大的机制，对于特定的复杂系统编程任务，它是是非常必要的，它也有一些缺点。

## 第 54 条：谨慎地使用本地方法

## 第 55 条：谨慎地进行优化

不要费力去编写快速的程序——应该努力编写好的程序，速度自然会随之而来。

## 第 56 条：遵守普遍接受的命名惯例

1. 包

    包的名称应该是层次状的，用句号分隔每个部分。

    包名称的其余部分应该包括一个或者多个描述该包的组成部分。

2. 类和接口，包括枚举和注解类型

    类和接口，包括枚举和注解类型的名称，都应该包括一个或者多个单词，每个单词的首字母大写（**强烈建议采用仅有首字母大写的形式**）。

3. 方法和域

4. 常量域

    常量域的名称应该包含一个或者多个大写的单词，中间用下划线隔开。

5. 局部变量

6. 类型参数

    T 表示任意类型，E 表示集合的元素类型，K 和 V 表示映射的键和值类型，X 表示异常。

把标准的命名惯例当作一种内在的机制来看待，并且学着用它们作为第二特性。
